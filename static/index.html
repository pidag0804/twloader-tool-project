<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TWLoader 優化設定工具</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="app-container">
        <!-- Home View -->
        <div id="home-view">
            <header class="home-header">
                <h1>TWLoader 啟動 & 優化工具</h1>
                <p class="subtitle">選擇啟動遊戲或安裝優化模組</p>
            </header>

            <div id="path-config-area" class="path-config-area" style="display: none;">
                <p id="path-message">【檢查不到預設安裝資料夾，請手動選擇 TWLoader 主資料夾位置。】</p>
                <div class="path-buttons">
                    <button id="select-path-button">選擇 TWLoader 資料夾</button>
                    <button id="reset-path-button" style="display: none;">重設路徑</button>
                </div>
            </div>

            <main class="home-grid">
                <div id="launch-plus-card" class="home-card" style="display: none;">
                    <h2>啟動一般模式</h2>
                    <p>點啟動後將開啟 一般模式</p>
                    <div class="home-card-actions">
                        <button class="update-button" data-mode="plus">檢查更新</button>
                        <button class="launch-button" data-mode="plus">啟動</button>
                    </div>
                </div>

                <div id="launch-plusup-card" class="home-card" style="display: none;">
                    <h2>啟動 UP 改歌模式</h2>
                    <p>點啟動後將開啟 UP 改歌模式</p>
                    <div class="home-card-actions">
                         <button class="update-button" data-mode="plusup">檢查更新</button>
                        <button class="launch-button" data-mode="plusup">啟動</button>
                    </div>
                </div>

                <div id="install-optimizations-card" class="home-card" style="display: none;">
                    <h2>安裝優化</h2>
                    <p>進入優化安裝介面</p>
                     <div class="home-card-actions">
                        <button class="primary-action-button" id="go-to-optimize-view">進入</button>
                    </div>
                </div>
                
                <!-- ========================================================= -->
                <!-- 【NEW】: Resolution adjustment card -->
                <!-- ========================================================= -->
                <div id="resolution-tool-card" class="home-card">
                    <h2>遊戲解析度</h2>
                    <p>調整遊戲視窗或全螢幕解析度</p>
                     <div class="home-card-actions">
                        <button class="primary-action-button" id="go-to-resolution-view">調整解析度</button>
                    </div>
                </div>
            </main>
        </div>

        <!-- Optimization View -->
        <div id="optimize-view" style="display: none;">
            <header>
                <button id="back-to-home-button" title="返回主畫面"> &lt; 返回</button>
                <h1>TWLoader 優化設定工具</h1>
                <div class="mode-selector">
                    <input type="radio" id="mode-plus" name="mode" value="plus" checked>
                    <label for="mode-plus">一般模式</label>
                    <input type="radio" id="mode-plusup" name="mode" value="plusup">
                    <label for="mode-plusup">UP模式</label>
                </div>
                <div id="target-path-display">目標路徑: 讀取中...</div>
            </header>
            
            <nav class="tabs">
                <button class="tab-link active" data-category="room">房間優化</button>
                <button class="tab-link" data-category="gui">介面優化</button>
                <button class="tab-link" data-category="scene">場景優化</button>
                <button class="tab-link" data-category="beatup">BeatUP模式專用</button>
                <button class="tab-link" data-category="black-tech">黑科技</button>
            </nav>

            <main id="content">
                <div id="card-grid" class="card-grid"></div>
                <div id="preview-panel">
                    <img id="preview-image" src="" alt="預覽圖">
                </div>
            </main>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- 【NEW】: Resolution adjustment modal/view -->
    <!-- ========================================================= -->
    <div id="resolution-view" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <header class="modal-header">
                <h2>調整遊戲解析度</h2>
                <button id="close-resolution-view" class="close-button">&times;</button>
            </header>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">顯示模式</label>
                    <div class="radio-group">
                        <input type="radio" id="res-mode-windowed" name="winMode" value="1" checked>
                        <label for="res-mode-windowed">視窗化模式</label>
                        <input type="radio" id="res-mode-fullscreen" name="winMode" value="0">
                        <label for="res-mode-fullscreen">全螢幕模式</label>
                        <input type="radio" id="res-mode-fullscreen-43" name="winMode" value="2">
                        <label for="res-mode-fullscreen-43">全螢幕 4:3 模式</label>
                    </div>
                </div>
                <div class="form-group" id="resolution-select-group">
                    <label for="resolution-select" class="form-label">選擇解析度</label>
                    <select id="resolution-select">
                        <option value="800x600">800 x 600 (4:3)</option>
                        <option value="1024x768" selected>1024 x 768 (4:3)</option>
                        <option value="1280x720">1280 x 720 (16:9)</option>
                        <option value="1366x768">1366 x 768 (16:9)</option>
                        <option value="1440x900">1440 x 900 (16:10)</option>
                        <option value="1600x900">1600 x 900 (16:9)</option>
                        <option value="1920x1080">1920 x 1080 (16:9)</option>
                    </select>
                </div>
                <p class="info-text">注意：全螢幕模式將強制使用 1024x768 解析度，遊戲開啟後再按F4按鍵即可。</p>
            </div>
            <footer class="modal-footer">
                <button id="save-resolution-button" class="primary-action-button">儲存設定</button>
            </footer>
        </div>
    </div>
    
    <div id="toast-container"></div>

    <template id="card-template">
        <div class="card">
            <div class="card-image-container">
                <img class="card-thumb" src="" alt="">
            </div>
            <div class="card-body">
                <h3 class="card-title"></h3>
                <div class="card-actions">
                    <button class="install-button" style="display: none;">
                        <span class="btn-text">安裝</span>
                        <div class="spinner" style="display: none;"></div>
                    </button>
                    <button class="uninstall-button" style="display: none;">
                        <span class="btn-text">移除</span>
                        <div class="spinner" style="display: none;"></div>
                    </button>
                </div>
            </div>
        </div>
    </template>

    <script src="/static/script.js"></script>
</body>
</html>